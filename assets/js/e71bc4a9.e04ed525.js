"use strict";(globalThis.webpackChunkdev_tips=globalThis.webpackChunkdev_tips||[]).push([[3045],{932:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/dml-fonctions-exemple-dd9be021a09322212e5fa43fd0849448.PNG"},1393:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/dml-insert-default-490d5b1be91548f4c60129002fa85407.PNG"},2661:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/dml-insert-56aa3fdf9d7fde0f2197c3748c701d5a.PNG"},3770:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"H2WM/SQL/M4-DML","title":"Le langage de requ\xeate SQL avec SQL Server","description":"DML : La gestion des donn\xe9es","source":"@site/docs/H2WM/SQL/M4-DML.md","sourceDirName":"H2WM/SQL","slug":"/H2WM/SQL/M4-DML","permalink":"/dev-tips/docs/H2WM/SQL/M4-DML","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"M3-demo","permalink":"/dev-tips/docs/H2WM/SQL/M3-demo"},"next":{"title":"M4-demo","permalink":"/dev-tips/docs/H2WM/SQL/M4-demo"}}');var i=s(4848),r=s(8453);const l={sidebar_position:5},a="Le langage de requ\xeate SQL avec SQL Server",d={},c=[{value:"DML : La gestion des donn\xe9es",id:"dml--la-gestion-des-donn\xe9es",level:2},{value:"Les Litt\xe9raux",id:"les-litt\xe9raux",level:3},{value:"Les op\xe9rateurs",id:"les-op\xe9rateurs",level:3},{value:"Les Fonctions",id:"les-fonctions",level:3},{value:"Ins\xe9rer des donn\xe9es INSERT",id:"ins\xe9rer-des-donn\xe9es-insert",level:3},{value:"Processus d&#39;affectation des valeurs",id:"processus-daffectation-des-valeurs",level:4},{value:"Metttre \xe0 jour des donn\xe9es UPDATE",id:"metttre-\xe0-jour-des-donn\xe9es-update",level:3},{value:"Supprimer des donn\xe9es DELETE",id:"supprimer-des-donn\xe9es-delete",level:3},{value:"Transaction et Rollback",id:"transaction-et-rollback",level:3}];function o(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"le-langage-de-requ\xeate-sql-avec-sql-server",children:"Le langage de requ\xeate SQL avec SQL Server"})}),"\n",(0,i.jsx)(n.h2,{id:"dml--la-gestion-des-donn\xe9es",children:"DML : La gestion des donn\xe9es"}),"\n",(0,i.jsx)(n.p,{children:"SELECT : Ce que je veux voir (* pour toutes les colonnes)\r\nFROM : d'o\xf9 \xe7a vient / la table"}),"\n",(0,i.jsx)(n.h3,{id:"les-litt\xe9raux",children:"Les Litt\xe9raux"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"alt text",src:s(4890).A+"",width:"676",height:"405"})}),"\n",(0,i.jsx)(n.h3,{id:"les-op\xe9rateurs",children:"Les op\xe9rateurs"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"alt text",src:s(8890).A+"",width:"675",height:"397"})}),"\n",(0,i.jsx)(n.p,{children:"L'op\xe9rateur LIKE :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Jokers (entre '')","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"_ remplace 1 caract\xe8re"}),"\n",(0,i.jsxs)(n.li,{children:["% remplace un nombre quelconque de caract\xe8res ",(0,i.jsx)(n.strong,{children:"entre 0 et infini"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Exemples","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"LIKE 'G%' commence par un G"}),"\n",(0,i.jsx)(n.li,{children:"LIKE '_x%1' le second caract\xe8re est un x et se termine par un 1"}),"\n",(0,i.jsx)(n.li,{children:"LIKE '%a%'contient le caract\xe8re a"}),"\n",(0,i.jsx)(n.li,{children:"LIKE '%a' se termine par a"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"les-fonctions",children:"Les Fonctions"}),"\n",(0,i.jsx)(n.p,{children:"Transact SQL :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Agr\xe9gation COUNT,SUM,AVG,MIN,MAX"}),"\n",(0,i.jsx)(n.li,{children:"MAth\xe9matique PI,SIN,COS"}),"\n",(0,i.jsx)(n.li,{children:"Date GETDATE,DATEDIFF"}),"\n",(0,i.jsx)(n.li,{children:"Chaine de caract\xe8re SUBSTRING,TRIM,LOWER,UPPER"}),"\n",(0,i.jsx)(n.li,{children:"Syst\xe8me COALESCE,NEWID,ROW_NUMBER"}),"\n",(0,i.jsx)(n.li,{children:"Conversion CONVERT,PARSE"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"alt text",src:s(932).A+"",width:"904",height:"242"})}),"\n",(0,i.jsx)(n.h3,{id:"ins\xe9rer-des-donn\xe9es-insert",children:"Ins\xe9rer des donn\xe9es INSERT"}),"\n",(0,i.jsx)(n.p,{children:"Mot cl\xe9 : INSERT"}),"\n",(0,i.jsx)(n.p,{children:"INSERT INTO : on liste toutes les colonnes a renseigner\r\nVALUES : on indique les donn\xe9es"}),"\n",(0,i.jsxs)(n.p,{children:["En respectant dans values l'ordre du INTO\r\n",(0,i.jsx)(n.img,{alt:"alt text",src:s(2661).A+"",width:"801",height:"55"})]}),"\n",(0,i.jsxs)(n.p,{children:["On peut mettre DEFAULT \xe0 la place d'une valeur\r\n",(0,i.jsx)(n.img,{alt:"alt text",src:s(1393).A+"",width:"798",height:"62"})]}),"\n",(0,i.jsx)(n.p,{children:"Il est possible de ne pas rappeler les colonnes mais moins lisibles et moins maintenable"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"alt text",src:s(7505).A+"",width:"800",height:"61"})}),"\n",(0,i.jsx)(n.h4,{id:"processus-daffectation-des-valeurs",children:"Processus d'affectation des valeurs"}),"\n",(0,i.jsx)(n.p,{children:"La question Colonne sp\xe9cifi\xe9e ? concerne ce que l'on trouve dans les parenth\xe8se du INTO"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"alt text",src:s(7530).A+"",width:"912",height:"393"})}),"\n",(0,i.jsx)(n.p,{children:"d\xe9mo :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-SQL",children:"INSERT INTO Clients (nom, prenom, date_naissance, ville, portable, fixe)\r\nVALUES ('DUCHEMIN','Julie','10/09/2001','Paris',0606235208,0240053897);\r\n\r\nINSERT INTO Clients (nom, prenom, date_naissance, portable, fixe)\r\nVALUES ('BEAUPLET','Lucas','10/09/1997',0606234508,0240052897);\r\n\r\nINSERT INTO Categories (libelle)\r\nVALUES ('Outillage'),\r\n('Jardin');\r\n\r\nINSERT INTO Commandes (date_cmd, statut , id_Client)\r\nVALUES(GETDATE(),'EP',15);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"metttre-\xe0-jour-des-donn\xe9es-update",children:"Metttre \xe0 jour des donn\xe9es UPDATE"}),"\n",(0,i.jsx)(n.p,{children:"Mot cl\xe9 : UPDATE\r\nSET : la colonne \xe0 changer\r\nWHERE : sert de filtre pour d\xe9terminer quelles lignes  seront affect\xe9es si elles existent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-SQL",children:"UPDATE Categories SET libelle =UPPER(libelle);\r\n\r\nUPDATE Clients SET date_naissance = '20/09/2001' WHERE id_client = 15;\r\nUPDATE Clients SET date_naissance = '18/09/1997', ville='Lyon' WHERE id_client = 15;\r\nUPDATE Clients SET ville='Lyon' WHERE ville = 'Paris' AND date_naissance < '18/09/1997';\n"})}),"\n",(0,i.jsx)(n.h3,{id:"supprimer-des-donn\xe9es-delete",children:"Supprimer des donn\xe9es DELETE"}),"\n",(0,i.jsx)(n.p,{children:"Mot cl\xe9 : DELETE\r\nFROM : la table cibl\xe9e\r\nWHERE : sert de filtre pour d\xe9terminer quelles lignes  seront affect\xe9es si elles existent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-SQL",children:"DELETE FROM Categories;\r\nDELETE FROM Clients WHERE date_naissance <'15/09/1997';\r\n\r\nDELETE FROM Clients WHERE id_client = 15;\r\n-- grace au on delete cascade les commandes seront automatiquement supprim\xe9es\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Les commandes ",(0,i.jsx)(n.strong,{children:"UPDATE et DELETE"})," sont consid\xe9r\xe9es comme des ",(0,i.jsx)(n.strong,{children:"op\xe9rations dangereuses si elles ne sont pas utilis\xe9es avec une clause WHERE"})," restrictive."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"alt text",src:s(7085).A+"",width:"773",height:"301"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"R\xe8gle d'Or"})," : Lorsque l'on utilise UPDATE ou DELETE, on commence toujours par \xe9crire la clause WHERE, ou on ex\xe9cute d'abord un SELECT * FROM Table WHERE [votre condition] pour confirmer les lignes cibl\xe9es."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"transaction-et-rollback",children:"Transaction et Rollback"}),"\n",(0,i.jsx)(n.p,{children:"Utiliser si on a plusieurs actions \xe0 faire pour la m\xeame commande par exemple (plusieurs lignes \xe0 ex\xe9cuter)"}),"\n",(0,i.jsx)(n.p,{children:"Mot cl\xe9 :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["BEGIN TRAN nom_transaction; ",(0,i.jsx)(n.strong,{children:"D\xe9but"})," de la transaction manuellement : les commandes (INSERT,UPDATE,DELETE) sont mises en attente"]}),"\n",(0,i.jsxs)(n.li,{children:["ROLLBACK TRAN nom_transaction; ",(0,i.jsx)(n.strong,{children:"Annule"})," retour \xe0 l'\xe9tat avant l'a transaction"]}),"\n",(0,i.jsxs)(n.li,{children:["COMMIT TRAN nom_transaction; ",(0,i.jsx)(n.strong,{children:"Valide"})," la transaction, les donn\xe9es d\xe9finitivement"]}),"\n",(0,i.jsx)(n.li,{children:"SAVE TRAN nom_transaction; D\xe9clarer un point de contr\xf4le au sein d'une transaction"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Si on ouvre une transaction manuellement ",(0,i.jsx)(n.strong,{children:"sinon c'est implicite"}),",\r\nil faut penser \xe0 la refermer"]}),"\n",(0,i.jsx)(n.p,{children:"Principes ACID"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Atomique : comme une seule instruction"}),"\n",(0,i.jsx)(n.li,{children:"Consistant : donn\xe9es coh\xe9rentes apr\xe8s la transaction"}),"\n",(0,i.jsx)(n.li,{children:"Ind\xe9pendant : donn\xe9es en cours de modification non visibles en dehors de la transaction"}),"\n",(0,i.jsx)(n.li,{children:"Dur\xe9e : apr\xe8s la transaction les changements sont durables"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-SQL",children:"BEGIN TRAN tran_test; -- transaction \"en attente\" \"avec un verrou\"\r\nUPDATE Categories SET libelle =UPPER(libelle);\r\n\r\nUPDATE Clients SET date_naissance = '20/09/2001' WHERE id_client = 15;\r\nUPDATE Clients SET date_naissance = '18/09/1997', ville='Lyon' WHERE id_client = 15;\r\nUPDATE Clients SET ville='Lyon' WHERE ville = 'Paris' AND date_naissance < '18/09/1997';\r\n\r\nDELETE FROM Categories;\r\nDELETE FROM Clients WHERE date_naissance <'15/09/1997';\r\n\r\nDELETE FROM Clients WHERE id_client = 15;\r\n\r\nROLLBACK TRAN tran_test; -- retour dans l'\xe9tat de la Base de donn\xe9es avant le begin tran\r\n\r\nCOMMIT TRAN tran_test; -- valide les donn\xe9es d\xe9finitivement\r\n\r\n--r\xe9initialiser l'identity de la tables fiches (ex avec un compeur d\xe9marrant \xe0 1000)\r\nDBCC CHECKIDENT ('Fiches', RESEED, 1000);\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},4890:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/dml-litteraux-c52a6b3cf91c9ae297af362f4d44a95f.PNG"},7085:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/DML-RECAP-201fe5bf107bacc28ccdfcbed258bbd1.PNG"},7505:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/dml-insert-moins-lisible-a1945b9ad299b6dcd849ab90c187b0b6.PNG"},7530:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/dml-processus-affectation-ef4d07d53ce3feca5287b3a963699894.PNG"},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var t=s(6540);const i={},r=t.createContext(i);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:n},e.children)}},8890:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/dml-operateurs-94aad3405a5c1c0ac90590d0b97461d1.PNG"}}]);